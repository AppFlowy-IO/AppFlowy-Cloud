{
  "db_name": "PostgreSQL",
  "query": "\n      WITH template_view_creator_account_link AS (\n        SELECT\n          view_id,\n          tv.creator_id,\n          COALESCE(\n            ARRAY_AGG((al.link_type, al.url)::account_link_type) FILTER (WHERE link_type IS NOT NULL),\n            '{}'\n          ) AS account_links\n        FROM af_template_view tv\n        JOIN af_template_creator tc\n        ON tv.creator_id = tc.creator_id\n        LEFT OUTER JOIN af_template_creator_account_link al\n        ON tc.creator_id = al.creator_id\n        WHERE view_id = $1\n        GROUP BY (view_id, tv.creator_id)\n      ),\n      related_template_view_template_category AS (\n        SELECT\n          rtv.related_view_id,\n          ARRAY_AGG(\n            (\n              tcg.category_id,\n              tcg.name,\n              tcg.icon,\n              tcg.bg_color\n            )::template_category_minimal_type\n          ) AS categories\n        FROM af_related_template_view rtv\n        JOIN af_template_view_template_category tvc\n        ON rtv.related_view_id = tvc.view_id\n        JOIN af_template_category tcg\n        ON tvc.category_id = tcg.category_id\n        WHERE rtv.view_id = $1\n        GROUP BY rtv.related_view_id\n      ),\n      template_view_related_template AS (\n        SELECT\n          rtv.view_id,\n          ARRAY_AGG(\n            (\n              rtv.related_view_id,\n              tv.created_at,\n              tv.updated_at,\n              tv.name,\n              tv.description,\n              tv.view_url,\n              (\n                tc.creator_id,\n                tc.name,\n                tc.avatar_url\n              )::template_creator_minimal_type,\n              rtvtc.categories,\n              tv.is_new_template,\n              tv.is_featured\n            )::template_minimal_type\n          ) AS related_templates\n        FROM af_related_template_view rtv\n        JOIN af_template_view tv\n        ON rtv.related_view_id = tv.view_id\n        JOIN af_template_creator tc\n        ON tv.creator_id = tc.creator_id\n        JOIN related_template_view_template_category rtvtc\n        ON rtv.related_view_id = rtvtc.related_view_id\n        WHERE rtv.view_id = $1\n        GROUP BY rtv.view_id\n      ),\n      template_view_template_category AS (\n        SELECT\n          view_id,\n          COALESCE(\n            ARRAY_AGG((\n              vtc.category_id,\n              name,\n              icon,\n              bg_color,\n              description,\n              category_type,\n              priority\n            )) FILTER (WHERE vtc.category_id IS NOT NULL),\n            '{}'\n          ) AS categories\n        FROM af_template_view_template_category vtc\n        JOIN af_template_category tc\n        ON vtc.category_id = tc.category_id\n        WHERE view_id = $1\n        GROUP BY view_id\n      ),\n      creator_number_of_templates AS (\n        SELECT\n          creator_id,\n          COUNT(*) AS number_of_templates\n        FROM af_template_view\n        GROUP BY creator_id\n      )\n\n      SELECT\n        tv.view_id,\n        tv.created_at,\n        tv.updated_at,\n        tv.name,\n        tv.description,\n        tv.about,\n        tv.view_url,\n        (\n          atc.creator_id,\n          atc.name,\n          atc.avatar_url,\n          al.account_links,\n          ct.number_of_templates\n        )::template_creator_type AS \"creator!: AFTemplateCreatorRow\",\n        tc.categories AS \"categories!: Vec<AFTemplateCategoryRow>\",\n        COALESCE(rtv.related_templates, '{}') AS \"related_templates!: Vec<AFTemplateMinimalRow>\",\n        tv.is_new_template,\n        tv.is_featured\n      FROM af_template_view tv\n      JOIN af_template_creator atc\n      ON tv.creator_id = atc.creator_id\n      JOIN template_view_creator_account_link al\n      ON tv.view_id = al.view_id\n      LEFT OUTER JOIN template_view_related_template rtv\n      ON tv.view_id = rtv.view_id\n      JOIN template_view_template_category tc\n      ON tv.view_id = tc.view_id\n      LEFT OUTER JOIN creator_number_of_templates ct\n      ON tv.creator_id = ct.creator_id\n      WHERE tv.view_id = $1\n\n    ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "view_id",
        "type_info": "Uuid"
      },
      {
        "ordinal": 1,
        "name": "created_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 2,
        "name": "updated_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 3,
        "name": "name",
        "type_info": "Text"
      },
      {
        "ordinal": 4,
        "name": "description",
        "type_info": "Text"
      },
      {
        "ordinal": 5,
        "name": "about",
        "type_info": "Text"
      },
      {
        "ordinal": 6,
        "name": "view_url",
        "type_info": "Text"
      },
      {
        "ordinal": 7,
        "name": "creator!: AFTemplateCreatorRow",
        "type_info": {
          "Custom": {
            "name": "template_creator_type",
            "kind": {
              "Composite": [
                [
                  "creator_id",
                  "Uuid"
                ],
                [
                  "name",
                  "Text"
                ],
                [
                  "avatar_url",
                  "Text"
                ],
                [
                  "account_links",
                  {
                    "Custom": {
                      "name": "account_link_type[]",
                      "kind": {
                        "Array": {
                          "Custom": {
                            "name": "account_link_type",
                            "kind": {
                              "Composite": [
                                [
                                  "link_type",
                                  "Text"
                                ],
                                [
                                  "url",
                                  "Text"
                                ]
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                ],
                [
                  "number_of_templates",
                  "Int4"
                ]
              ]
            }
          }
        }
      },
      {
        "ordinal": 8,
        "name": "categories!: Vec<AFTemplateCategoryRow>",
        "type_info": "RecordArray"
      },
      {
        "ordinal": 9,
        "name": "related_templates!: Vec<AFTemplateMinimalRow>",
        "type_info": {
          "Custom": {
            "name": "template_minimal_type[]",
            "kind": {
              "Array": {
                "Custom": {
                  "name": "template_minimal_type",
                  "kind": {
                    "Composite": [
                      [
                        "view_id",
                        "Uuid"
                      ],
                      [
                        "created_at",
                        "Timestamptz"
                      ],
                      [
                        "updated_at",
                        "Timestamptz"
                      ],
                      [
                        "name",
                        "Text"
                      ],
                      [
                        "description",
                        "Text"
                      ],
                      [
                        "view_url",
                        "Text"
                      ],
                      [
                        "creator",
                        {
                          "Custom": {
                            "name": "template_creator_minimal_type",
                            "kind": {
                              "Composite": [
                                [
                                  "creator_id",
                                  "Uuid"
                                ],
                                [
                                  "name",
                                  "Text"
                                ],
                                [
                                  "avatar_url",
                                  "Text"
                                ]
                              ]
                            }
                          }
                        }
                      ],
                      [
                        "categories",
                        {
                          "Custom": {
                            "name": "template_category_minimal_type[]",
                            "kind": {
                              "Array": {
                                "Custom": {
                                  "name": "template_category_minimal_type",
                                  "kind": {
                                    "Composite": [
                                      [
                                        "category_id",
                                        "Uuid"
                                      ],
                                      [
                                        "name",
                                        "Text"
                                      ],
                                      [
                                        "icon",
                                        "Text"
                                      ],
                                      [
                                        "bg_color",
                                        "Text"
                                      ]
                                    ]
                                  }
                                }
                              }
                            }
                          }
                        }
                      ],
                      [
                        "is_new_template",
                        "Bool"
                      ],
                      [
                        "is_featured",
                        "Bool"
                      ]
                    ]
                  }
                }
              }
            }
          }
        }
      },
      {
        "ordinal": 10,
        "name": "is_new_template",
        "type_info": "Bool"
      },
      {
        "ordinal": 11,
        "name": "is_featured",
        "type_info": "Bool"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid"
      ]
    },
    "nullable": [
      false,
      false,
      false,
      false,
      false,
      false,
      false,
      null,
      null,
      null,
      false,
      false
    ]
  },
  "hash": "ac8e4be65f69964dcd3dcf8b64e150e9ecf84dd34db77eabfed84b3d713672d6"
}
